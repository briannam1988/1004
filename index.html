<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI 상황별 문구 생성기 | 세련된 업무·일상 메시지 작성</title>

    <!-- SEO -->
    <meta name="description" content="사용자 유지율을 높이기 위해 새롭게 디자인된 AI 문구 생성기. 로딩 상태, 생성 기록 등 UX가 개선되었습니다." />
    <meta name="keywords" content="문구 생성기, 메시지 예문, 업무 이메일, AI 문구, UX, 사용자 유지율" />

    <!-- Google Adsense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8164071407412804"
     crossorigin="anonymous"></script>

    <!-- External Stylesheet -->
    <link rel="stylesheet" href="style.css">

</head>
<body>

<div class="container">
    <h1>AI 상황별 문구 생성기 ✨</h1>

    <label for="situation">어떤 상황인가요?</label>
    <select id="situation">
        <option value="apology">사과</option>
        <option value="request">요청</option>
        <option value="report">보고</option>
        <option value="rejection">거절</option>
    </select>

    <label for="tone">어떤 톤으로 말할까요?</label>
    <select id="tone">
        <option value="polite">정중하게</option>
        <option value="casual">부드럽게</option>
        <option value="direct">간결하게</option>
    </select>

    <label for="detail">추가 정보 (선택)</label>
    <textarea id="detail" rows="4" placeholder="예: 회의에 10분 정도 늦을 것 같습니다."></textarea>

    <button id="generateBtn" onclick="generateText()">🚀 문구 생성하기</button>

    <div class="result-section">
        <h2>생성된 문구</h2>
        <div id="result">
            <div class="loader"></div>
            <p id="result-text"></p>
        </div>
        <button id="copyBtn" class="copy-btn" style="display:none;" onclick="copyText()">복사하기</button>
    </div>

    <div class="history-section">
        <h2>최근 생성 기록</h2>
        <ul id="history-list">
            <!-- History items will be injected here by JavaScript -->
        </ul>
    </div>

</div>

<script>
const generateBtn = document.getElementById('generateBtn');
const resultText = document.getElementById('result-text');
const resultContainer = document.getElementById('result');
const loader = document.querySelector('.loader');
const copyBtn = document.getElementById('copyBtn');
const historyList = document.getElementById('history-list');

// Load history from localStorage on page load
document.addEventListener('DOMContentLoaded', () => {
    loadHistory();
});

function generateText() {
    const situation = document.getElementById("situation").value;
    const tone = document.getElementById("tone").value;
    const detail = document.getElementById("detail").value;

    // --- UI Update: Show Loader ---
    resultText.innerText = "";
    loader.style.display = 'block';
    copyBtn.style.display = 'none';
    generateBtn.disabled = true;
    generateBtn.innerText = '생성 중...';

    // --- AI Simulation with setTimeout ---
    setTimeout(() => {
        let text = "";
        // Dummy logic, will be replaced by actual AI API call
        if (situation === "apology") {
            text = `정말 죄송합니다. ${detail || '예상치 못한 이슈로 불편을 드렸습니다.'} 다음부터는 이런 일이 없도록 더욱 주의하겠습니다.`;
        } else if (situation === "request") {
            text = `안녕하세요. ${detail || '도움이 필요한 부분이 있어'} 정중히 요청드립니다. 혹시 가능하실까요?`;
        } else if (situation === "report") {
            text = `[업무 보고] ${detail || '요청하신 건에 대한 진행 상황'} 공유드립니다. 확인 부탁드립니다.`;
        } else if (situation === "rejection") {
            text = `제안 주셔서 정말 감사합니다. 다만, ${detail || '내부 사정으로 인해'} 이번에는 아쉽게도 함께하기 어려울 것 같습니다.`;
        }

        // --- UI Update: Show Result ---
        resultText.innerText = text;
        loader.style.display = 'none';
        copyBtn.style.display = 'block';
        generateBtn.disabled = false;
        generateBtn.innerText = '🚀 문구 생성하기';
        
        // --- Save to History ---
        saveToHistory(text);

    }, 1200); // Simulating network delay
}

function copyText() {
    const text = resultText.innerText;
    if (text) {
        navigator.clipboard.writeText(text);
        alert("문구가 클립보드에 복사되었습니다.");
    }
}

function saveToHistory(text) {
    if (!text) return;

    let history = JSON.parse(localStorage.getItem('generationHistory')) || [];

    // Add new item to the top, avoid duplicates
    history = history.filter(item => item !== text); // Remove existing
    history.unshift(text); // Add to the front

    // Keep only the last 5 items
    if (history.length > 5) {
        history.pop();
    }

    localStorage.setItem('generationHistory', JSON.stringify(history));
    loadHistory();
}

function loadHistory() {
    historyList.innerHTML = '';
    const history = JSON.parse(localStorage.getItem('generationHistory')) || [];

    history.forEach(text => {
        const li = document.createElement('li');
        li.className = 'history-item';
        li.innerText = text.length > 50 ? text.substring(0, 50) + '...' : text;
        li.onclick = () => {
            resultText.innerText = text;
            copyBtn.style.display = 'block';
            window.scrollTo(0, 0);
        };
        historyList.appendChild(li);
    });
}
</script>

</body>
</html>
